<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Hess's Law Interactive</title>
<link href="https://fonts.googleapis.com/css2?family=DM+Serif+Display&family=Source+Sans+3:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<style>
:root {
  --purple: #6B46C1;
  --purple-light: #F3E8FF;
  --gold: #B7791F;
  --gold-light: #FEFCBF;
  --exo-warm: #D94F30;
  --exo-light: #FFF0EB;
  --endo-cool: #2B6CB0;
  --endo-light: #EBF4FF;
  --slate-900: #1A202C;
  --slate-700: #334155;
  --slate-500: #64748B;
  --slate-400: #94A3B8;
  --slate-300: #CBD5E1;
  --slate-200: #E2E8F0;
  --slate-100: #F1F5F9;
}

* { margin: 0; padding: 0; box-sizing: border-box; }

body {
  font-family: 'Source Sans 3', sans-serif;
  background: #FAFAF7;
  color: #1A202C;
  line-height: 1.7;
}

.hero {
  background: linear-gradient(135deg, var(--purple) 0%, var(--slate-900) 50%, var(--endo-cool) 100%);
  padding: 3rem 2rem 2.5rem;
  text-align: center;
  color: white;
}

.hero h1 {
  font-family: 'DM Serif Display', serif;
  font-size: 2.5rem;
  margin-bottom: 0.5rem;
}

.container {
  max-width: 1800px;
  margin: 0 auto;
  padding: 2rem 2rem;
}

/* THREE-PANEL LAYOUT */
.workspace-container {
  display: grid;
  grid-template-columns: 1fr 480px;
  gap: 2rem;
  margin-top: 2rem;
  overflow: visible;
}

.right-panels {
  display: flex;
  flex-direction: column;
  gap: 1rem;
  position: sticky;
  top: 1.5rem;
  overflow: visible;
}

/* LEFT PANEL: WORKSPACE */
.workspace {
  background: white;
  border: 3px solid var(--purple);
  border-radius: 12px;
  padding: 1.5rem;
  min-height: 750px;
  display: flex;
  flex-direction: column;
}

.workspace h2 {
  font-family: 'DM Serif Display', serif;
  color: var(--purple);
  font-size: 1.15rem;
  margin-bottom: 0.75rem;
  text-align: center;
}

.reactions-list {
  flex: 1;
  overflow-y: auto;
  margin-bottom: 1rem;
}

.reaction-item {
  background: var(--slate-100);
  border: 2px solid var(--slate-300);
  border-radius: 8px;
  padding: 1rem;
  margin-bottom: 0.75rem;
  cursor: pointer;
  transition: all 0.2s;
  position: relative;
}

.reaction-item:hover {
  border-color: var(--purple);
  box-shadow: 0 2px 8px rgba(107,70,193,0.15);
}

.reaction-item.selected {
  border-color: var(--purple);
  background: var(--purple-light);
  box-shadow: 0 0 0 3px rgba(107,70,193,0.1);
}

.reaction-item.reversed {
  background: var(--gold-light);
  border-color: var(--gold);
}

.reaction-item.multiplied {
  background: var(--endo-light);
  border-color: var(--endo-cool);
}

.reaction-equation {
  font-family: 'Courier New', monospace;
  font-size: 1rem;
  font-weight: 600;
  text-align: center;
  margin-bottom: 0.5rem;
}

.reaction-dh {
  text-align: center;
  font-weight: 700;
  font-size: 1.1rem;
}

.reaction-dh.exo { color: var(--exo-warm); }
.reaction-dh.endo { color: var(--endo-cool); }

.remove-btn {
  position: absolute;
  top: 0.5rem;
  left: 0.5rem;
  background: var(--exo-warm);
  color: white;
  border: none;
  border-radius: 4px;
  padding: 0.2rem 0.5rem;
  cursor: pointer;
  font-size: 0.75rem;
  font-weight: 600;
}

.remove-btn:hover {
  background: #B03D23;
}

.badge {
  position: absolute;
  top: 0.5rem;
  right: 0.5rem;
  background: var(--gold);
  color: white;
  padding: 0.15rem 0.5rem;
  border-radius: 4px;
  font-size: 0.65rem;
  font-weight: 700;
}

.badge.multiplied-badge {
  background: var(--endo-cool);
}

.workspace-footer {
  border-top: 2px solid var(--slate-200);
  padding-top: 1rem;
  display: flex;
  flex-direction: column;
  gap: 1rem;
}

.net-equation-panel {
  background: var(--purple-light);
  border: 2px solid var(--purple);
  border-radius: 8px;
  padding: 0.75rem 1rem;
  display: none;
}

.net-equation-panel.show {
  display: block;
}

.net-eq-label {
  font-weight: 700;
  font-size: 0.85rem;
  color: var(--purple);
  text-transform: uppercase;
  letter-spacing: 0.5px;
  margin-bottom: 0.4rem;
}

.net-eq-display {
  font-size: 1.1rem;
  font-weight: 600;
  color: var(--slate-900);
  line-height: 1.5;
  margin-bottom: 0.3rem;
  text-align: center;
}

.net-dh-display {
  font-size: 1rem;
  font-weight: 700;
  margin-top: 0.3rem;
  text-align: center;
}

.net-dh-display.exo {
  color: var(--exo-warm);
}

.net-dh-display.endo {
  color: var(--endo-cool);
}

.workspace-buttons {
  display: flex;
  gap: 1rem;
}

.btn {
  flex: 1;
  padding: 0.75rem;
  border-radius: 8px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.2s;
}

.btn-clear {
  background: white;
  border: 2px solid var(--purple);
  color: var(--purple);
}

.btn-clear:hover {
  background: var(--purple-light);
}

.btn-calculate {
  background: var(--purple);
  border: none;
  color: white;
}

.btn-calculate:hover {
  background: #5A38A3;
}

.btn-calculate:disabled {
  background: var(--slate-300);
  cursor: not-allowed;
}

/* RIGHT SIDEBAR: TWO PANELS */

/* PANEL 1: REACTION LIBRARY */
.library-panel {
  background: white;
  border: 3px solid var(--slate-400);
  border-radius: 12px;
  padding: 1rem;
  padding-top: 1.5rem;
  max-height: 400px;
  display: flex;
  flex-direction: column;
  position: relative;
}

.library-panel::before {
  content: 'PANEL 1';
  position: absolute;
  top: -10px;
  left: 12px;
  background: var(--slate-400);
  color: white;
  padding: 0.25rem 0.7rem;
  border-radius: 4px;
  font-size: 0.7rem;
  font-weight: 700;
  letter-spacing: 0.5px;
  z-index: 10;
}

.library-panel h3 {
  font-family: 'DM Serif Display', serif;
  font-size: 1.1rem;
  margin-bottom: 0.75rem;
  text-align: center;
}

.filter-group {
  margin-bottom: 0.75rem;
}

.filter-group label {
  display: block;
  font-weight: 600;
  font-size: 0.85rem;
  margin-bottom: 0.4rem;
  color: var(--slate-700);
}

select {
  width: 100%;
  padding: 0.5rem;
  border: 2px solid var(--slate-300);
  border-radius: 6px;
  font-family: inherit;
  font-size: 0.9rem;
  background: white;
  cursor: pointer;
}

select:focus {
  outline: none;
  border-color: var(--purple);
  box-shadow: 0 0 0 3px rgba(107,70,193,0.1);
}

/* ========== CONCEPT QUESTIONS SECTION ========== */
.concept-questions-fullwidth{
  width:100%;
  margin:2rem 0;
  padding:2rem;
  background:white;
  border-top:3px solid var(--purple);
  border-bottom:3px solid var(--purple);
}
.qs{
  max-width:82.5%;
  margin:0 auto;
  padding:2rem 0;
  display:flex;
  flex-direction:column;
  gap:1.25rem;
}
.qs h3{
  font-family:'DM Serif Display',serif;
  font-size:1.4rem;
  text-align:center;
  margin-bottom:.5rem;
  color:var(--slate-900);
}
.qc-question{
  background:#fff;
  border:2px solid #CBD5E1;
  border-radius:10px;
  padding:1.25rem;
  transition:all .2s;
}
.qc-question-text{
  font-weight:600;
  font-size:1.05rem;
  color:#1A202C;
  margin-bottom:1rem;
  line-height:1.6;
}
.qc-question-text strong{
  color:var(--purple);
  text-transform:uppercase;
  font-size:0.85rem;
  letter-spacing:0.5px;
}
.qc-options{
  display:flex;
  flex-direction:column;
  gap:.6rem;
}
.qc-option{
  display:flex;
  align-items:flex-start;
  gap:.75rem;
  padding:.85rem 1rem;
  background:#F1F5F9;
  border:2px solid #E2E8F0;
  border-radius:8px;
  cursor:pointer;
  transition:all .2s;
  min-height:52px;
}
.qc-option:hover:not(.locked){
  background:#F3E8FF;
  border-color:var(--purple);
  transform:translateX(2px);
}
.qc-letter{
  flex-shrink:0;
  width:28px;
  height:28px;
  border-radius:50%;
  background:#CBD5E1;
  color:#1A202C;
  display:flex;
  align-items:center;
  justify-content:center;
  font-weight:700;
  font-size:.9rem;
  transition:all .2s;
}
.qc-option span:last-child{
  flex:1;
  line-height:1.5;
  color:#334155;
  font-size:.98rem;
}
.qc-option.locked{
  cursor:not-allowed;
}
.qc-option.correct-pick{
  background:#F0FFF4;
  border-color:#2F855A;
}
.qc-option.correct-pick .qc-letter{
  background:#2F855A;
  color:#fff;
}
.qc-option.wrong-pick{
  background:#FFF0EB;
  border-color:#D94F30;
}
.qc-option.wrong-pick .qc-letter{
  background:#D94F30;
  color:#fff;
}
.qc-option.reveal-correct{
  background:#F0FFF4;
  border-color:#2F855A;
  opacity:.7;
}
.qc-option.reveal-correct .qc-letter{
  background:#2F855A;
  color:#fff;
}
.qc-feedback-inline{
  margin-top:.85rem;
  padding:.85rem 1rem;
  border-radius:6px;
  font-size:.95rem;
  line-height:1.6;
  display:none;
}
.qc-feedback-inline.show{
  display:block;
}
.qc-feedback-inline.correct{
  background:#F0FFF4;
  color:#22543D;
  border-left:4px solid #2F855A;
}
.qc-feedback-inline.incorrect{
  background:#FFF0EB;
  color:#742A2A;
  border-left:4px solid #D94F30;
}


.reactions-scroll {
  flex: 1;
  overflow-y: auto;
}

.library-item {
  background: white;
  border: 2px solid var(--slate-300);
  border-radius: 8px;
  padding: 0.75rem;
  margin-bottom: 0.6rem;
  cursor: pointer;
  transition: all 0.2s;
  text-align: center;
}

.library-item:hover {
  border-color: var(--purple);
  transform: translateX(-3px);
  box-shadow: 0 2px 8px rgba(107,70,193,0.15);
}

.library-equation {
  font-family: 'Courier New', monospace;
  font-size: 0.85rem;
  font-weight: 600;
  margin-bottom: 0.4rem;
}

.library-dh {
  font-weight: 700;
  font-size: 0.9rem;
  margin-bottom: 0.3rem;
}

.library-dh.exo { color: var(--exo-warm); }
.library-dh.endo { color: var(--endo-cool); }

.library-label {
  font-size: 0.7rem;
  color: var(--slate-500);
}

/* PANEL 2: ADJUSTMENT PANEL */
.adjust-panel {
  background: white;
  border: 3px solid var(--gold);
  border-radius: 12px;
  padding: 1rem;
  padding-top: 1.5rem;
  max-height: 56.25vh;
  display: flex;
  flex-direction: column;
  position: relative;
  margin-top: 0.5rem;
}

.panel-badge-gold {
  position: absolute;
  top: -10px;
  left: 12px;
  background: var(--gold);
  color: white;
  padding: 0.25rem 0.7rem;
  border-radius: 4px;
  font-size: 0.7rem;
  font-weight: 700;
  letter-spacing: 0.5px;
  z-index: 10;
}

.adjust-panel.disabled {
  opacity: 0.6;
  pointer-events: none;
}

.adjust-panel h3 {
  font-family: 'DM Serif Display', serif;
  font-size: 1.05rem;
  color: var(--gold);
  margin-bottom: 0.75rem;
  text-align: center;
}

.current-equation {
  background: var(--gold-light);
  padding: 0.75rem;
  border-radius: 6px;
  font-family: 'Courier New', monospace;
  font-size: 0.85rem;
  font-weight: 600;
  text-align: center;
  margin-bottom: 1rem;
}

.adjust-group {
  margin-bottom: 1rem;
}

.adjust-group label {
  display: block;
  font-weight: 700;
  font-size: 0.85rem;
  margin-bottom: 0.4rem;
  color: var(--slate-700);
}

.adjust-group select {
  border-color: var(--slate-300);
}

.adjust-group select:focus {
  border-color: var(--gold);
  box-shadow: 0 0 0 3px rgba(183,121,31,0.1);
}

.adjust-dh {
  text-align: center;
  font-weight: 700;
  font-size: 1.1rem;
  padding: 0.75rem;
  background: white;
  border-radius: 6px;
  border: 2px solid var(--slate-200);
  margin: 1rem 0;
}

.adjust-dh.exo {
  color: var(--exo-warm);
  background: var(--exo-light);
  border-color: var(--exo-warm);
}

.adjust-dh.endo {
  color: var(--endo-cool);
  background: var(--endo-light);
  border-color: var(--endo-cool);
}

.back-btn {
  width: 100%;
  padding: 0.6rem;
  background: white;
  border: 2px solid var(--gold);
  color: var(--gold);
  border-radius: 6px;
  font-weight: 600;
  cursor: pointer;
}

.back-btn:hover {
  background: var(--gold-light);
}

.empty-state {
  text-align: center;
  padding: 3rem 1.5rem;
  color: var(--slate-500);
  font-style: italic;
}

/* RESULTS */
.results {
  background: white;
  border: 3px solid var(--purple);
  border-radius: 12px;
  padding: 1.5rem;
  margin-top: 2rem;
  display: none;
}

.results.show {
  display: block;
}

.results h2 {
  font-family: 'DM Serif Display', serif;
  color: var(--purple);
  margin-bottom: 1rem;
}

.result-steps {
  margin: 1rem 0;
}

.result-step {
  background: var(--slate-100);
  padding: 0.75rem;
  border-left: 4px solid var(--slate-400);
  border-radius: 4px;
  margin-bottom: 0.5rem;
  font-family: 'Courier New', monospace;
  font-size: 0.9rem;
}

.result-total {
  background: #F0FFF4;
  border: 3px solid #2F855A;
  border-radius: 8px;
  padding: 1.5rem;
  margin-top: 1.5rem;
  text-align: center;
}

.result-total-dh {
  font-size: 1.5rem;
  font-weight: 700;
  margin-top: 0.5rem;
}

.result-total-dh.exo { color: var(--exo-warm); }
.result-total-dh.endo { color: var(--endo-cool); }

@media (max-width: 1024px) {
  .workspace-container {
    grid-template-columns: 1fr;
  }
  .right-panels {
    position: static;
  }
  .library-panel, .adjust-panel {
    max-height: 400px;
  }
}
</style>
</head>
<body>

<div class="hero">
  <h1>Hess's Law Interactive Explorer</h1>
  <p>Workspace Left • Library & Adjustment Right</p>
</div>

<div class="container">
  <div class="workspace-container">
    
    <!-- LEFT: LARGE WORKSPACE -->
    <div class="workspace">
      <h2>Your Workspace</h2>
      <div class="reactions-list" id="workspace">
        <div class="empty-state">
          Select reactions from the library &rarr;
        </div>
      </div>
      <div class="workspace-footer">
        <div class="net-equation-panel" id="netEqPanel">
          <div class="net-eq-label">Net Equation:</div>
          <div class="net-eq-display" id="netEqDisplay">Add reactions to workspace</div>
          <div class="net-dh-display" id="netDHDisplay"></div>
        </div>
        <div class="workspace-buttons">
          <button class="btn btn-clear" onclick="clearAll()">Clear All</button>
        </div>
      </div>
    </div>

    <!-- RIGHT: TWO STACKED PANELS -->
    <div class="right-panels">
      
      <!-- PANEL 1: REACTION LIBRARY -->
      <div class="library-panel">
        <h3>Reaction Library</h3>
        <div class="filter-group">
          <label>Filter by Category:</label>
          <select id="categoryFilter" onchange="filterReactions()">
            <option value="all">All Reactions</option>
            <option value="combustion">Combustion</option>
            <option value="formation">Formation</option>
            <option value="decomposition">Decomposition</option>
            <option value="phase">Phase Change</option>
          </select>
        </div>
        <div class="reactions-scroll" id="library"></div>
      </div>

      <!-- PANEL 2: ADJUSTMENT PANEL -->
      <div class="adjust-panel disabled" id="adjustPanel">
        <div class="panel-badge-gold">PANEL 2</div>
        <h3>Adjust Selected Reaction</h3>
        <div class="current-equation" id="currentEq">Select a reaction from workspace</div>
        
        <div class="adjust-group">
          <label for="directionSelect">Direction:</label>
          <select id="directionSelect" onchange="updateDirection()">
            <option value="forward">&rarr; Forward</option>
            <option value="reversed">&larr; Reversed</option>
          </select>
        </div>

        <div class="adjust-group">
          <label for="coeffSelect">Multiply by:</label>
          <select id="coeffSelect" onchange="updateCoefficient()">
            <option value="1">1 (original)</option>
            <option value="2">2 (double)</option>
            <option value="3">3 (triple)</option>
            <option value="0.5">½ (half)</option>
            <option value="0.333">⅓ (one-third)</option>
          </select>
        </div>


      </div>

    </div>
  </div>

</div>

<!-- FULL-WIDTH CONCEPT QUESTIONS SECTION -->
<div class="concept-questions-fullwidth">
  <div class="qs">
    <h3>Concept Check Questions</h3>
    <p style="color: var(--slate-700); margin-bottom: 1.5rem; font-size: 0.95rem;">Complete these questions using the interactive tool above. Each question requires you to actually use the workspace to find the answer.</p>

    <!-- Q1: Simple Addition -->
    <div class="qc-question" id="q1">
      <div class="qc-question-text"><strong>DIRECTIONS:</strong> Add "Carbon combustion" and "Hydrogen combustion" to your workspace (do NOT modify them). Look at the Net Equation panel.<br><br>1. What is the net ΔH when these two reactions are combined?</div>
      <div class="qc-options">
        <div class="qc-option" onclick="checkMC('q1','a')">
          <span class="qc-letter">A</span>
          <span>-679.3 kJ</span>
        </div>
        <div class="qc-option" onclick="checkMC('q1','b')">
          <span class="qc-letter">B</span>
          <span>-107.7 kJ</span>
        </div>
        <div class="qc-option" onclick="checkMC('q1','c')">
          <span class="qc-letter">C</span>
          <span>+679.3 kJ</span>
        </div>
        <div class="qc-option" onclick="checkMC('q1','d')">
          <span class="qc-letter">D</span>
          <span>+107.7 kJ</span>
        </div>
      </div>
      <div class="qc-feedback-inline" id="q1-fb"></div>
    </div>

    <!-- Q2: Understanding Reversal -->
    <div class="qc-question" id="q2">
      <div class="qc-question-text"><strong>DIRECTIONS:</strong> Click "Clear All". Add "Water decomposition" to your workspace. Click on it, then change Direction to "← Reversed" in Panel 2.<br><br>2. After reversing, what is the ΔH value displayed?</div>
      <div class="qc-options">
        <div class="qc-option" onclick="checkMC('q2','a')">
          <span class="qc-letter">A</span>
          <span>+571.6 kJ (same as original)</span>
        </div>
        <div class="qc-option" onclick="checkMC('q2','b')">
          <span class="qc-letter">B</span>
          <span>-571.6 kJ (opposite sign)</span>
        </div>
        <div class="qc-option" onclick="checkMC('q2','c')">
          <span class="qc-letter">C</span>
          <span>0 kJ (cancels out)</span>
        </div>
        <div class="qc-option" onclick="checkMC('q2','d')">
          <span class="qc-letter">D</span>
          <span>+285.8 kJ (half the value)</span>
        </div>
      </div>
      <div class="qc-feedback-inline" id="q2-fb"></div>
    </div>

    <!-- Q3: Multiplication Effect -->
    <div class="qc-question" id="q3">
      <div class="qc-question-text"><strong>DIRECTIONS:</strong> Click "Clear All". Add "Ammonia (Haber)" to workspace. Select it, then in Panel 2 change "Multiply by" to "2".<br><br>3. What happens to the ΔH value when you multiply the equation by 2?</div>
      <div class="qc-options">
        <div class="qc-option" onclick="checkMC('q3','a')">
          <span class="qc-letter">A</span>
          <span>ΔH stays the same (-92.2 kJ)</span>
        </div>
        <div class="qc-option" onclick="checkMC('q3','b')">
          <span class="qc-letter">B</span>
          <span>ΔH doubles (-184.4 kJ)</span>
        </div>
        <div class="qc-option" onclick="checkMC('q3','c')">
          <span class="qc-letter">C</span>
          <span>ΔH is divided by 2 (-46.1 kJ)</span>
        </div>
        <div class="qc-option" onclick="checkMC('q3','d')">
          <span class="qc-letter">D</span>
          <span>ΔH becomes positive (+92.2 kJ)</span>
        </div>
      </div>
      <div class="qc-feedback-inline" id="q3-fb"></div>
    </div>

    <!-- Q4: Combining ΔH Values -->
    <div class="qc-question" id="q4">
      <div class="qc-question-text"><strong>DIRECTIONS:</strong> Click "Clear All". Add "Methane combustion" (ΔH = -890.3 kJ) to your workspace. Then add "Water decomposition" (ΔH = +571.6 kJ).<br><br>4. What is the total ΔH when you combine these two reactions?</div>
      <div class="qc-options">
        <div class="qc-option" onclick="checkMC('q4','a')">
          <span class="qc-letter">A</span>
          <span>-318.7 kJ</span>
        </div>
        <div class="qc-option" onclick="checkMC('q4','b')">
          <span class="qc-letter">B</span>
          <span>-1461.9 kJ</span>
        </div>
        <div class="qc-option" onclick="checkMC('q4','c')">
          <span class="qc-letter">C</span>
          <span>+318.7 kJ</span>
        </div>
        <div class="qc-option" onclick="checkMC('q4','d')">
          <span class="qc-letter">D</span>
          <span>+1461.9 kJ</span>
        </div>
      </div>
      <div class="qc-feedback-inline" id="q4-fb"></div>
    </div>

    <!-- Q5: Why Reverse Equations -->
    <div class="qc-question" id="q5">
      <div class="qc-question-text"><strong>DIRECTIONS:</strong> Your goal is to find ΔH for: 2 C(s) + 2 H₂(g) → C₂H₄(g). You cannot measure this directly, but you have combustion data. Look at "Carbon combustion," "Hydrogen combustion," and "Ethene combustion" in the library.<br><br>5. To use "Ethene combustion" to help find ΔH for ethene FORMATION, what must you do?</div>
      <div class="qc-options">
        <div class="qc-option" onclick="checkMC('q5','a')">
          <span class="qc-letter">A</span>
          <span>Use it as-is because it already contains C₂H₄</span>
        </div>
        <div class="qc-option" onclick="checkMC('q5','b')">
          <span class="qc-letter">B</span>
          <span>Reverse it because combustion has C₂H₄ as a reactant, but we need it as a product</span>
        </div>
        <div class="qc-option" onclick="checkMC('q5','c')">
          <span class="qc-letter">C</span>
          <span>Multiply it by 2</span>
        </div>
        <div class="qc-option" onclick="checkMC('q5','d')">
          <span class="qc-letter">D</span>
          <span>You cannot use combustion data to find formation ΔH</span>
        </div>
      </div>
      <div class="qc-feedback-inline" id="q5-fb"></div>
    </div>

    <!-- Q6: Applying the Strategy -->
    <div class="qc-question" id="q6">
      <div class="qc-question-text"><strong>DIRECTIONS:</strong> Use the tool! Add these to workspace: "Carbon combustion" (multiply by 2), "Hydrogen combustion" (multiply by 2), and "Ethene combustion" (reverse it). Look at the Net Equation and Net ΔH.<br><br>6. What is the net ΔH for forming ethene: 2 C(s) + 2 H₂(g) → C₂H₄(g)?</div>
      <div class="qc-options">
        <div class="qc-option" onclick="checkMC('q6','a')">
          <span class="qc-letter">A</span>
          <span>+52.4 kJ</span>
        </div>
        <div class="qc-option" onclick="checkMC('q6','b')">
          <span class="qc-letter">B</span>
          <span>-52.4 kJ</span>
        </div>
        <div class="qc-option" onclick="checkMC('q6','c')">
          <span class="qc-letter">C</span>
          <span>+1411 kJ</span>
        </div>
        <div class="qc-option" onclick="checkMC('q6','d')">
          <span class="qc-letter">D</span>
          <span>-1411 kJ</span>
        </div>
      </div>
      <div class="qc-feedback-inline" id="q6-fb"></div>
    </div>

    <!-- Q7: Hess's Law Application -->
    <div class="qc-question" id="q7">
      <div class="qc-question-text"><strong>DIRECTIONS:</strong> Now YOU choose the strategy! Use the library to find ΔH for: C(s) + 2 H₂(g) → CH₄(g). You'll need to select and manipulate equations strategically.<br><br>7. What is ΔH for methane formation from its elements?</div>
      <div class="qc-options">
        <div class="qc-option" onclick="checkMC('q7','a')">
          <span class="qc-letter">A</span>
          <span>-74.6 kJ</span>
        </div>
        <div class="qc-option" onclick="checkMC('q7','b')">
          <span class="qc-letter">B</span>
          <span>+74.6 kJ</span>
        </div>
        <div class="qc-option" onclick="checkMC('q7','c')">
          <span class="qc-letter">C</span>
          <span>-890.3 kJ</span>
        </div>
        <div class="qc-option" onclick="checkMC('q7','d')">
          <span class="qc-letter">D</span>
          <span>+890.3 kJ</span>
        </div>
      </div>
      <div class="qc-feedback-inline" id="q7-fb"></div>
    </div>

  </div>
</div>

<script>
const reactions = [
  // REQUIRED FOR CONCEPT CHECK QUESTIONS
  { id: 'r1', eq: 'C(s) + O<sub>2</sub>(g) → CO<sub>2</sub>(g)', dH: -393.5, cat: 'combustion', label: 'Carbon combustion' },
  { id: 'r2', eq: 'CO(g) + ½ O<sub>2</sub>(g) → CO<sub>2</sub>(g)', dH: -283.0, cat: 'combustion', label: 'CO combustion' },
  { id: 'r3', eq: 'H<sub>2</sub>(g) + ½ O<sub>2</sub>(g) → H<sub>2</sub>O(l)', dH: -285.8, cat: 'combustion', label: 'Hydrogen combustion' },
  { id: 'r4', eq: 'CH<sub>4</sub>(g) + 2 O<sub>2</sub>(g) → CO<sub>2</sub>(g) + 2 H<sub>2</sub>O(l)', dH: -890.3, cat: 'combustion', label: 'Methane combustion' },
  { id: 'r5', eq: '2 H<sub>2</sub>O(l) → 2 H<sub>2</sub>(g) + O<sub>2</sub>(g)', dH: 571.6, cat: 'decomposition', label: 'Water decomposition' },
  { id: 'r6', eq: 'N<sub>2</sub>(g) + 3 H<sub>2</sub>(g) → 2 NH<sub>3</sub>(g)', dH: -92.2, cat: 'formation', label: 'Ammonia synthesis' },
  
  // ADDITIONAL REACTIONS FOR HESS'S LAW PRACTICE - Rich in O₂, H₂O, CO₂, H₂
  { id: 'r7', eq: 'C<sub>2</sub>H<sub>6</sub>(g) + 7/2 O<sub>2</sub>(g) → 2 CO<sub>2</sub>(g) + 3 H<sub>2</sub>O(l)', dH: -1560, cat: 'combustion', label: 'Ethane combustion' },
  { id: 'r8', eq: 'C<sub>2</sub>H<sub>4</sub>(g) + 3 O<sub>2</sub>(g) → 2 CO<sub>2</sub>(g) + 2 H<sub>2</sub>O(l)', dH: -1411, cat: 'combustion', label: 'Ethene combustion' },
  { id: 'r9', eq: 'C<sub>2</sub>H<sub>2</sub>(g) + 5/2 O<sub>2</sub>(g) → 2 CO<sub>2</sub>(g) + H<sub>2</sub>O(l)', dH: -1300, cat: 'combustion', label: 'Ethyne combustion' },
  { id: 'r10', eq: '2 C(s) + 3 H<sub>2</sub>(g) → C<sub>2</sub>H<sub>6</sub>(g)', dH: -84.0, cat: 'formation', label: 'Ethane formation' },
  { id: 'r11', eq: '2 C(s) + 2 H<sub>2</sub>(g) → C<sub>2</sub>H<sub>4</sub>(g)', dH: 52.4, cat: 'formation', label: 'Ethene formation' },
  { id: 'r12', eq: '2 C(s) + H<sub>2</sub>(g) → C<sub>2</sub>H<sub>2</sub>(g)', dH: 226.7, cat: 'formation', label: 'Ethyne formation' },
  { id: 'r13', eq: 'CH<sub>3</sub>OH(l) + 3/2 O<sub>2</sub>(g) → CO<sub>2</sub>(g) + 2 H<sub>2</sub>O(l)', dH: -726.1, cat: 'combustion', label: 'Methanol combustion' },
  { id: 'r14', eq: 'CO(g) + 2 H<sub>2</sub>(g) → CH<sub>3</sub>OH(l)', dH: -128.1, cat: 'formation', label: 'Methanol synthesis' },
  { id: 'r15', eq: 'C(s) + 2 H<sub>2</sub>(g) → CH<sub>4</sub>(g)', dH: -74.6, cat: 'formation', label: 'Methane formation' },
  { id: 'r16', eq: 'H<sub>2</sub>O(l) → H<sub>2</sub>O(g)', dH: 44.0, cat: 'phase', label: 'Water vaporization' },
  { id: 'r17', eq: '4 NH<sub>3</sub>(g) + 5 O<sub>2</sub>(g) → 4 NO(g) + 6 H<sub>2</sub>O(l)', dH: -905.2, cat: 'combustion', label: 'Ammonia oxidation' },
  { id: 'r18', eq: 'N<sub>2</sub>(g) + 2 O<sub>2</sub>(g) → 2 NO<sub>2</sub>(g)', dH: 66.4, cat: 'formation', label: 'NO₂ formation (direct)' }
];


let workspace = [];
let selectedIdx = null;
let currentCat = 'all';

function init() {
  renderLibrary();
}

function filterReactions() {
  currentCat = document.getElementById('categoryFilter').value;
  renderLibrary();
}

function renderLibrary() {
  const filtered = currentCat === 'all' ? reactions : reactions.filter(r => r.cat === currentCat);
  document.getElementById('library').innerHTML = filtered.map(r => `
    <div class="library-item" onclick="addToWorkspace('${r.id}')">
      <div class="library-equation">${r.eq}</div>
      <div class="library-dh ${r.dH < 0 ? 'exo' : 'endo'}">ΔH = ${r.dH > 0 ? '+' : ''}${r.dH} kJ</div>
      <div class="library-label">${r.label}</div>
    </div>
  `).join('');
}

function addToWorkspace(id) {
  const rxn = reactions.find(r => r.id === id);
  workspace.push({ ...rxn, reversed: false, coeff: 1 });
  renderWorkspace();
}

function renderWorkspace() {
  const ws = document.getElementById('workspace');
  if (workspace.length === 0) {
    ws.innerHTML = '<div class="empty-state">Select reactions from the library &rarr;</div>';
    document.getElementById('netEqPanel').classList.remove('show');
    return;
  }

  ws.innerHTML = workspace.map((r, i) => {
    let eq = multiplyEq(r.eq, r.coeff);
    if (r.reversed) eq = reverseEq(eq);
    eq = cleanEquation(eq); // Clean up any decimal coefficients
    const dh = r.dH * r.coeff * (r.reversed ? -1 : 1);
    const isSelected = selectedIdx === i;
    
    return `
      <div class="reaction-item ${r.reversed ? 'reversed' : ''} ${r.coeff !== 1 ? 'multiplied' : ''} ${isSelected ? 'selected' : ''}"
           onclick="selectReaction(${i})">
        <button class="remove-btn" onclick="event.stopPropagation(); removeReaction(${i})">&times;</button>
        ${r.reversed ? '<div class="badge">REVERSED</div>' : ''}
        ${r.coeff !== 1 && !r.reversed ? '<div class="badge multiplied-badge">MULTIPLIED</div>' : ''}
        <div class="reaction-equation">${eq}</div>
        <div class="reaction-dh ${dh < 0 ? 'exo' : 'endo'}">ΔH = ${dh > 0 ? '+' : ''}${dh.toFixed(1)} kJ</div>
      </div>
    `;
  }).join('');
  
  computeNetEquation();
}

function cleanEquation(eq) {
  // Replace any decimal coefficients with fractions
  return eq.replace(/(\d+\.\d+)\s+/g, (match, decimal) => {
    const num = parseFloat(decimal);
    const frac = decimalToFraction(num);
    return frac + ' ';
  });
}

function computeNetEquation() {
  if (workspace.length === 0) {
    document.getElementById('netEqPanel').classList.remove('show');
    return;
  }
  
  // Parse all species from all equations
  let allReactants = {};
  let allProducts = {};
  let totalDH = 0;
  
  workspace.forEach(r => {
    let eq = multiplyEq(r.eq, r.coeff);
    if (r.reversed) eq = reverseEq(eq);
    const dh = r.dH * r.coeff * (r.reversed ? -1 : 1);
    totalDH += dh;
    
    const parts = eq.split('→');
    if (parts.length !== 2) return;
    
    // Parse reactants
    parseSpecies(parts[0].trim(), allReactants);
    // Parse products
    parseSpecies(parts[1].trim(), allProducts);
  });
  
  // Cancel common species
  for (let species in allReactants) {
    if (allProducts[species]) {
      const cancel = Math.min(allReactants[species], allProducts[species]);
      allReactants[species] -= cancel;
      allProducts[species] -= cancel;
      if (allReactants[species] === 0) delete allReactants[species];
      if (allProducts[species] === 0) delete allProducts[species];
    }
  }
  
  // Format net equation
  const reactantStr = formatSpecies(allReactants);
  const productStr = formatSpecies(allProducts);
  const netEq = reactantStr && productStr ? `${reactantStr} → ${productStr}` : 'No net reaction';
  
  document.getElementById('netEqDisplay').innerHTML = netEq;
  
  const dhDisplay = document.getElementById('netDHDisplay');
  dhDisplay.textContent = `ΔH = ${totalDH > 0 ? '+' : ''}${totalDH.toFixed(1)} kJ`;
  dhDisplay.className = 'net-dh-display ' + (totalDH < 0 ? 'exo' : 'endo');
  
  document.getElementById('netEqPanel').classList.add('show');
}

function parseSpecies(side, dict) {
  const terms = side.split('+').map(t => t.trim());
  terms.forEach(term => {
    const match = term.match(/^([\d\/½⅓⅔.]+)?\s*(.+)$/);
    if (!match) return;
    
    let coeff = 1;
    if (match[1]) {
      if (match[1] === '½') coeff = 0.5;
      else if (match[1] === '⅓') coeff = 1/3;
      else if (match[1] === '⅔') coeff = 2/3;
      else coeff = parseFloat(match[1]);
    }
    
    const species = match[2].trim();
    dict[species] = (dict[species] || 0) + coeff;
  });
}

function formatSpecies(dict) {
  return Object.entries(dict)
    .filter(([_, coeff]) => coeff > 0)
    .map(([species, coeff]) => {
      if (coeff === 1) return species;
      
      // Try to convert to fraction
      const fracStr = decimalToFraction(coeff);
      return `${fracStr} ${species}`;
    })
    .join(' + ');
}

function decimalToFraction(decimal) {
  // Handle common fractions first
  if (decimal === 0.5) return '½';
  if (Math.abs(decimal - 1/3) < 0.0001) return '⅓';
  if (Math.abs(decimal - 2/3) < 0.0001) return '⅔';
  if (Math.abs(decimal - 1/4) < 0.0001) return '¼';
  if (Math.abs(decimal - 3/4) < 0.0001) return '¾';
  if (Math.abs(decimal - 1/5) < 0.0001) return '⅕';
  if (Math.abs(decimal - 2/5) < 0.0001) return '⅖';
  if (Math.abs(decimal - 3/5) < 0.0001) return '⅗';
  if (Math.abs(decimal - 4/5) < 0.0001) return '⅘';
  if (Math.abs(decimal - 1/6) < 0.0001) return '⅙';
  if (Math.abs(decimal - 5/6) < 0.0001) return '⅚';
  if (Math.abs(decimal - 1/8) < 0.0001) return '⅛';
  if (Math.abs(decimal - 3/8) < 0.0001) return '⅜';
  if (Math.abs(decimal - 5/8) < 0.0001) return '⅝';
  if (Math.abs(decimal - 7/8) < 0.0001) return '⅞';
  
  // For other decimals, try to find a simple fraction
  const tolerance = 0.0001;
  
  // Try denominators up to 20
  for (let denom = 2; denom <= 20; denom++) {
    for (let numer = 1; numer < denom * 10; numer++) {
      if (Math.abs(decimal - numer/denom) < tolerance) {
        // Simplify the fraction
        const gcd = (a, b) => b === 0 ? a : gcd(b, a % b);
        const g = gcd(numer, denom);
        const simpleNumer = numer / g;
        const simpleDenom = denom / g;
        
        // If it's a whole number, return as integer
        if (simpleDenom === 1) return simpleNumer.toString();
        
        // Check if we have a Unicode fraction for this
        const unicodeFrac = getUnicodeFraction(simpleNumer, simpleDenom);
        if (unicodeFrac) return unicodeFrac;
        
        // Otherwise return as "n/d"
        return `${simpleNumer}/${simpleDenom}`;
      }
    }
  }
  
  // If no simple fraction found, return as decimal
  return decimal.toString();
}

function getUnicodeFraction(numerator, denominator) {
  const fractions = {
    '1/2': '½', '1/3': '⅓', '2/3': '⅔', '1/4': '¼', '3/4': '¾',
    '1/5': '⅕', '2/5': '⅖', '3/5': '⅗', '4/5': '⅘',
    '1/6': '⅙', '5/6': '⅚',
    '1/8': '⅛', '3/8': '⅜', '5/8': '⅝', '7/8': '⅞'
  };
  return fractions[`${numerator}/${denominator}`] || null;
}


function selectReaction(idx) {
  selectedIdx = idx;
  const r = workspace[idx];
  
  document.getElementById('adjustPanel').classList.remove('disabled');
  
  let eq = multiplyEq(r.eq, r.coeff);
  if (r.reversed) eq = reverseEq(eq);
  document.getElementById('currentEq').innerHTML = eq;
  
  document.getElementById('directionSelect').value = r.reversed ? 'reversed' : 'forward';
  document.getElementById('coeffSelect').value = r.coeff === 1/3 ? '0.333' : r.coeff.toString();
  
  renderWorkspace();
}

function deselect() {
  selectedIdx = null;
  document.getElementById('adjustPanel').classList.add('disabled');
  document.getElementById('currentEq').textContent = 'Select a reaction from workspace';
  document.getElementById('directionSelect').value = 'forward';
  document.getElementById('coeffSelect').value = '1';
  renderWorkspace();
}

function updateDirection() {
  if (selectedIdx === null) return;
  workspace[selectedIdx].reversed = document.getElementById('directionSelect').value === 'reversed';
  selectReaction(selectedIdx);
}

function updateCoefficient() {
  if (selectedIdx === null) return;
  const val = document.getElementById('coeffSelect').value;
  workspace[selectedIdx].coeff = val === '0.333' ? 1/3 : parseFloat(val);
  selectReaction(selectedIdx);
}

function removeReaction(idx) {
  workspace.splice(idx, 1);
  if (selectedIdx === idx) deselect();
  else if (selectedIdx > idx) selectedIdx--;
  renderWorkspace();
}

function clearAll() {
  workspace = [];
  deselect();
  renderWorkspace();
}


function reverseEq(eq) {
  const parts = eq.split('→');
  return parts.length === 2 ? `${parts[1].trim()} → ${parts[0].trim()}` : eq;
}

function multiplyEq(eq, coeff) {
  if (coeff === 1) return eq;
  const parts = eq.split('→');
  if (parts.length !== 2) return eq;
  
  const multiply = (side) => {
    return side.split('+').map(term => {
      term = term.trim();
      const match = term.match(/^([\d\/½⅓⅔.]+)?\s*(.+)$/);
      if (!match) return term;
      
      let existingCoeff = match[1];
      const formula = match[2];
      let num = 1;
      
      if (existingCoeff) {
        if (existingCoeff === '½') {
          num = 0.5;
        } else if (existingCoeff === '⅓') {
          num = 1/3;
        } else if (existingCoeff === '⅔') {
          num = 2/3;
        } else {
          // Parse regular numbers like "2", "3", "2.5", etc.
          num = parseFloat(existingCoeff);
          if (isNaN(num)) num = 1;
        }
      }
      
      const newCoeff = num * coeff;
      let display = '';
      
      if (newCoeff === 1) {
        display = '';
      } else {
        // Use the decimalToFraction function for all coefficients
        display = decimalToFraction(newCoeff);
      }
      
      return display ? `${display} ${formula}` : formula;
    }).join(' + ');
  };
  
  return `${multiply(parts[0])} → ${multiply(parts[1])}`;
}

init();

// Multi-choice question answers and feedback
var mcAnswers={
  q1:{correct:'a',
      feedback:'Correct! When you add reactions together, you ADD their ΔH values: -393.5 kJ + (-285.8 kJ) = -679.3 kJ. The Net Equation panel shows this total.',
      wrongFeedback:'Not quite. Look at the Net ΔH value displayed in the purple box at the bottom of your workspace. When combining reactions, you ADD the individual ΔH values together.'},
  q2:{correct:'b',
      feedback:'Exactly right! When you reverse a reaction, the sign of ΔH flips. The original decomposition is +571.6 kJ (endothermic), but the reverse (forming water) is -571.6 kJ (exothermic).',
      wrongFeedback:'Remember: reversing a reaction changes the direction, which changes whether energy is absorbed or released. Check the ΔH value shown on your workspace card after reversing.'},
  q3:{correct:'b',
      feedback:'Perfect! When you multiply an equation by a coefficient, you multiply ΔH by the same factor. Original: -92.2 kJ. Multiplied by 2: -184.4 kJ. This makes sense—twice as much reaction releases twice as much energy!',
      wrongFeedback:'Look at the ΔH displayed on the workspace card after multiplying. When you double the amount of reaction, what happens to the energy released?'},
  q4:{correct:'a',
      feedback:'Exactly right! When you combine reactions in Hess\'s Law, you ADD their ΔH values. Here: (-890.3 kJ) + (+571.6 kJ) = -318.7 kJ. Check the Net ΔH display at the bottom of your workspace to confirm!',
      wrongFeedback:'Remember: in Hess\'s Law, when you combine multiple reactions, you ADD their ΔH values together. Look at the Net ΔH shown in the purple panel at the bottom of your workspace. What happens when you add -890.3 + 571.6?'},
  q5:{correct:'b',
      feedback:'Exactly! Ethene combustion shows: C₂H₄ + 3O₂ → 2CO₂ + 2H₂O. Here, C₂H₄ is a REACTANT (burns). But for formation, we need C₂H₄ as a PRODUCT (being made). Reversing gives: 2CO₂ + 2H₂O → C₂H₄ + 3O₂. This is the KEY insight: we can use combustion data backward to find formation enthalpies!',
      wrongFeedback:'Think about what "formation" means - making C₂H₄ from elements. In combustion, C₂H₄ is burning (reactant side). To get it on the product side (being formed), what operation moves species from one side to the other? Try looking at the ethene combustion equation in the library.'},
  q6:{correct:'a',
      feedback:'Perfect! You used Hess\'s Law to find a formation enthalpy from combustion data! Here\'s what happened: 2[C + O₂ → CO₂] gives -787.0 kJ, 2[H₂ + ½O₂ → H₂O] gives -571.6 kJ, and reversing [C₂H₄ + 3O₂ → 2CO₂ + 2H₂O] gives +1411 kJ. Net: -787.0 + (-571.6) + 1411 = +52.4 kJ. The O₂, CO₂, and H₂O all cancel out, leaving only 2C + 2H₂ → C₂H₄!',
      wrongFeedback:'Follow the directions step-by-step: (1) Add carbon combustion, multiply by 2, (2) Add hydrogen combustion, multiply by 2, (3) Add ethene combustion and REVERSE it. Check the Net ΔH display. Remember: 2×(-393.5) + 2×(-285.8) + (reverse of -1411) = ?'},
  q7:{correct:'a',
      feedback:'Excellent! You can find this two ways: (1) EASY: Just look in the library - "Methane formation" gives it directly! (2) HESS\'S LAW WAY: Use carbon combustion (C + O₂ → CO₂, ΔH = -393.5 kJ), 2× hydrogen combustion (2H₂ + O₂ → 2H₂O, ΔH = -571.6 kJ), and reverse methane combustion (CO₂ + 2H₂O → CH₄ + 2O₂, ΔH = +890.3 kJ). Net: -393.5 + (-571.6) + 890.3 = -74.6 kJ.',
      wrongFeedback:'Strategy hint: You need CH₄ as a product. Look for reactions containing CH₄. You can either (1) find it directly in the library, or (2) use methane combustion reversed, plus carbon and hydrogen combustion. Try building this in the workspace and check the Net ΔH!'}
};

function checkMC(questionId,picked){
  var q=document.getElementById(questionId);
  if(q.dataset.locked==='true')return;
  q.dataset.locked='true';
  
  var info=mcAnswers[questionId];
  var options=q.querySelectorAll('.qc-option');
  var letters=['a','b','c','d'];
  var fb=document.getElementById(questionId+'-fb');
  
  var isCorrect=picked===info.correct;
  
  options.forEach(function(opt,i){
    opt.classList.add('locked');
    if(letters[i]===picked&&isCorrect){
      opt.classList.add('correct-pick');
    }else if(letters[i]===picked&&!isCorrect){
      opt.classList.add('wrong-pick');
    }
    if(letters[i]===info.correct&&!isCorrect){
      opt.classList.add('reveal-correct');
    }
  });
  
  fb.className='qc-feedback-inline '+(isCorrect?'correct':'incorrect')+' show';
  fb.textContent=isCorrect?info.feedback:info.wrongFeedback;
}
</script>



</script>

</body>
</html>
